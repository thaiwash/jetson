define("discourse/plugins/discourse-user-notes/discourse/initializers/enable-user-notes",["exports","discourse/lib/plugin-api","discourse-common/lib/icon-library","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/utils/decorators"],function(e,t,m,f,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={name:"enable-user-notes",initialize:function(e){var c,d=e.lookup("site-settings:main"),s=e.lookup("current-user:main");d.user_notes_enabled&&s&&s.staff&&(c=e.lookup("store:main"),(0,t.withPluginApi)("0.8.15",function(e){var s,t,o,n,r,i,u;function a(){var s=this;(0,f.showUserNotes)(c,this.attrs.user_id,function(e){s.sendWidgetAction("refreshUserNotes",e)},{postId:this.attrs.id})}e.attachWidgetAction("post","refreshUserNotes",function(e){var s=this.model.user_custom_fields||{};s.user_notes_count=e,this.model.set("user_custom_fields",s)}),e.modifyClass("controller:user",(n=(0,p.on)("init"),i=(0,p.observes)("model"),t=l={userNotesCount:null,_modelChanged:function(){this.set("userNotesCount",this.get("model.custom_fields.user_notes_count")||0)},actions:{showUserNotes:function(){var s=this;(0,f.showUserNotes)(c,this.model.id,function(e){return s.set("userNotesCount",e)})}}},o="_modelChanged",n=[n,i],s=(s=Object.getOwnPropertyDescriptor(l,"_modelChanged"))?s.value:void 0,r={enumerable:!0,configurable:!0,writable:!0,initializer:function(){return s}},i=l,u={},Object.keys(r).forEach(function(e){u[e]=r[e]}),u.enumerable=!!u.enumerable,u.configurable=!!u.configurable,("value"in u||u.initializer)&&(u.writable=!0),u=n.slice().reverse().reduce(function(e,s){return s(t,o,e)||e},u),i&&void 0!==u.initializer&&(u.value=u.initializer?u.initializer.call(i):void 0,u.initializer=void 0),void 0===u.initializer&&(Object.defineProperty(t,o,u),u=null),l));var l=e.container.lookup("site:main").mobileView?"before":"after";e.decorateWidget("poster-name:".concat(l),function(e){if(!e.widget.settings.hideNotes)return 0<(e.attrs.userCustomFields||{}).user_notes_count?e.attach("user-notes-icon"):void 0}),e.decorateWidget("post-avatar:after",function(e){if(e.widget.settings.showNotes)return 0<(e.attrs.userCustomFields||{}).user_notes_count?e.attach("user-notes-icon"):void 0}),e.decorateWidget("post-admin-menu:after",function(e){return e.h("ul",e.attach("post-admin-menu-button",{icon:"pencil-alt",label:"user_notes.attach",action:"showUserNotes",secondaryAction:"closeAdminMenu"}))}),e.attachWidgetAction("post","showUserNotes",a),e.createWidget("user-notes-icon",{tagName:"span.user-notes-icon",click:a,html:function(){return d.enable_emoji?this.attach("emoji",{name:"pencil"}):(0,m.iconNode)("sticky-note")}})}))}};e.default=s}),define("discourse/plugins/discourse-user-notes/discourse/adapters/user-note",["exports","discourse/adapters/rest","discourse/lib/ajax"],function(e,s,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;s=s.default.extend({destroyRecord:function(e,s,t){s=this.pathFor(e,s,t.id);return(0,o.ajax)("".concat(s,"?user_id=").concat(t.user_id),{method:"DELETE"})}});e.default=s}),Ember.TEMPLATES["javascripts/modal/user-notes"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["n"],"statements":[[4,"d-modal-body",null,[["class"],["user-notes-modal"]],{"statements":[[0,"  "],[1,[28,"textarea",null,[["value"],[[24,["newNote"]]]]],false],[0,"\\n  "],[1,[28,"d-button",null,[["action","label","class","disabled"],[[28,"action",[[23,0,[]],"attachNote"],null],"user_notes.attach","btn-primary",[24,["attachDisabled"]]]]],false],[0,"\\n\\n"],[4,"each",[[24,["model"]]],null,{"statements":[[0,"    "],[7,"div",true],[10,"class","user-note"],[8],[0,"\\n      "],[7,"div",true],[10,"class","posted-by"],[8],[0,"\\n"],[4,"user-link",null,[["user"],[[23,1,["created_by"]]]],{"statements":[[0,"          "],[1,[28,"avatar",[[23,1,["created_by"]]],[["imageSize"],["small"]]],false],[0,"\\n"]],"parameters":[]},null],[0,"      "],[9],[0,"\\n      "],[7,"div",true],[10,"class","note-contents"],[8],[0,"\\n        "],[7,"div",true],[10,"class","note-info"],[8],[0,"\\n          "],[7,"span",true],[10,"class","username"],[8],[1,[23,1,["created_by","username"]],false],[9],[0,"\\n          "],[7,"span",true],[10,"class","post-date"],[8],[1,[28,"age-with-tooltip",[[23,1,["created_at"]]],null],false],[9],[0,"\\n\\n"],[4,"if",[[23,1,["can_delete"]]],null,{"statements":[[0,"            "],[7,"span",true],[10,"class","controls"],[8],[0,"\\n              "],[1,[28,"d-button",null,[["action","icon","class","title"],[[28,"action",[[23,0,[]],"removeNote",[23,1,[]]],null],"far-trash-alt","btn-small btn-danger","user_notes.remove"]]],false],[0,"\\n            "],[9],[0,"\\n"]],"parameters":[]},null],[0,"        "],[9],[0,"\\n\\n        "],[7,"div",true],[10,"class","cooked"],[8],[0,"\\n          "],[1,[28,"cook-text",[[23,1,["raw"]]],null],false],[0,"\\n        "],[9],[0,"\\n\\n"],[4,"if",[[23,1,["post_id"]]],null,{"statements":[[0,"          "],[1,[28,"d-button",null,[["class","href","action","title","translatedLabel"],["btn btn-small",[23,1,["post_url"]],[28,"route-action",["closeModal"],null],"user_notes.show_post",[28,"i18n",["user_notes.show_post"],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"      "],[9],[0,"\\n\\n      "],[7,"div",true],[10,"class","clearfix"],[8],[9],[0,"\\n    "],[9],[0,"\\n"]],"parameters":[1]},null]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/modal/user-notes"}}),Ember.TEMPLATES["javascripts/connectors/admin-dashboard-moderation-bottom/recent-user-notes-report-table"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[24,["siteSettings","user_notes_enabled"]]],null,{"statements":[[0,"  "],[1,[28,"admin-report",null,[["dataSourceName","startDate","endDate"],["user_notes",[24,["lastWeek"]],[24,["endDate"]]]]],false],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/connectors/admin-dashboard-moderation-bottom/recent-user-notes-report-table"}}),Ember.TEMPLATES["javascripts/components/show-user-notes"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"a",false],[12,"href",""],[12,"class","btn"],[3,"action",[[23,0,[]],[24,["show"]]]],[8],[0,"\\n  "],[1,[28,"d-icon",["pencil-alt"],null],false],[0,"\\n"],[4,"if",[[24,["showCount"]]],null,{"statements":[[0,"    "],[1,[28,"i18n",["user_notes.show"],[["count"],[[24,["count"]]]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"    "],[1,[28,"i18n",["user_notes.title"],null],false],[0,"\\n"]],"parameters":[]}],[9],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/components/show-user-notes"}}),define("discourse/plugins/discourse-user-notes/discourse/components/show-user-notes",["exports","@ember/component","@ember/object"],function(e,s,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;t=s.default.extend({tagName:"",showCount:t.computed.gt("count",0)});e.default=t}),define("discourse/plugins/discourse-user-notes/discourse/controllers/user-notes",["exports","I18n","discourse-common/utils/decorators","discourse/lib/ajax-error","@ember/controller"],function(e,o,s,n,t){"use strict";var r;function i(t,o,e,s,n){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=e.slice().reverse().reduce(function(e,s){return s(t,o,e)||e},r),n&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(n):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(t,o,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;s=t.default.extend((r=(0,s.on)("init"),t=(0,s.default)("newNote","saving"),i(s={newNote:null,saving:!1,user:null,reset:function(){this.setProperties({newNote:null,saving:!1,callback:null})},attachDisabled:function(e,s){return s||!e||0===e.length},_refreshCount:function(){this.callback&&this.callback(this.get("model.length"))},actions:{attachNote:function(){var e=this,s=this.store.createRecord("user-note"),t=parseInt(this.userId,10);this.set("saving",!0);t={raw:this.newNote,user_id:t};this.postId&&(t.post_id=parseInt(this.postId,10)),s.save(t).then(function(){e.set("newNote",""),e.model.insertAt(0,s),e._refreshCount()}).catch(n.popupAjaxError).finally(function(){return e.set("saving",!1)})},removeNote:function(s){var t=this;bootbox.confirm(o.default.t("user_notes.delete_confirm"),o.default.t("no_value"),o.default.t("yes_value"),function(e){e&&s.destroyRecord().then(function(){t.model.removeObject(s),t._refreshCount()}).catch(n.popupAjaxError)})}}},"reset",[r],Object.getOwnPropertyDescriptor(s,"reset"),s),i(s,"attachDisabled",[t],Object.getOwnPropertyDescriptor(s,"attachDisabled"),s),s));e.default=s}),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-card-post-names/show-user-notes-on-card",["exports","I18n","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner","discourse/lib/text"],function(e,o,n,r,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={shouldRender:function(e,s){var t=s.siteSettings,s=s.currentUser;return t.user_notes_enabled&&s&&s.staff},setupComponent:function(e,s){var t=e.user,e=t.user_notes_count||t.get("custom_fields.user_notes_count")||0;s.setProperties({userNotesCount:e,emojiEnabled:s.siteSettings.enable_emoji,emojiUrl:(0,i.emojiUrlFor)("pencil"),user:t,userNotesTitle:o.default.t("user_notes.show",{count:e})})},actions:{showUserNotes:function(){var s=this;this.parentView.parentView._close();var e=(0,r.getOwner)(this).lookup("store:main"),t=this.get("args.user");(0,n.showUserNotes)(e,t.id,function(e){s.isDestroying||s.isDestroyed||s.set("userNotesCount",e)})}}};e.default=s}),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/after-reviewable-post-user/show-user-notes-on-flags",["exports","I18n","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner","discourse/lib/text"],function(e,t,o,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={shouldRender:function(e,s){return s.siteSettings.user_notes_enabled&&e.user},setupComponent:function(e,s){e=e.user.get("custom_fields.user_notes_count")||0;s.setProperties({userNotesCount:e,emojiEnabled:s.siteSettings.enable_emoji,emojiUrl:(0,r.emojiUrlFor)("pencil"),userNotesTitle:t.default.t("user_notes.show",{count:e})})},actions:{showUserNotes:function(){var s=this,e=(0,n.getOwner)(this).lookup("store:main"),t=this.get("args.user");(0,o.showUserNotes)(e,t.id,function(e){return s.set("userNotesCount",e)})}}};e.default=s}),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-profile-controls/show-notes-on-profile",["exports","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner"],function(e,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={shouldRender:function(e,s){var t=s.siteSettings,s=s.currentUser;return t.user_notes_enabled&&s&&s.staff},setupComponent:function(e,s){e=e.model;s.set("userNotesCount",e.user_notes_count||e.get("custom_fields.user_notes_count")||0)},actions:{showUserNotes:function(){var s=this,e=(0,n.getOwner)(this).lookup("store:main"),t=this.get("args.model");(0,o.showUserNotes)(e,t.id,function(e){return s.set("userNotesCount",e)})}}};e.default=s}),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/admin-user-controls-after/add-user-notes-button",["exports","discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-profile-controls/show-notes-on-profile"],function(e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;s=s.default;e.default=s}),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/user-card-post-names/show-user-notes-on-card"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[24,["userNotesCount"]]],null,{"statements":[[0,"  "],[7,"a",false],[12,"href",""],[12,"title",[29,[[22,"userNotesTitle"]]]],[3,"action",[[23,0,[]],"showUserNotes"]],[8],[0,"\\n"],[4,"if",[[24,["emojiEnabled"]]],null,{"statements":[[0,"      "],[7,"img",true],[11,"src",[22,"emojiUrl"]],[11,"title",[22,"userNotesTitle"]],[10,"alt","pencil"],[10,"class","emoji"],[8],[9],[0,"\\n"]],"parameters":[]},{"statements":[[0,"      "],[1,[28,"d-icon",["sticky-note"],null],false],[0,"\\n"]],"parameters":[]}],[0,"  "],[9],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-user-notes/templates/connectors/user-card-post-names/show-user-notes-on-card"}}),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/after-reviewable-post-user/show-user-notes-on-flags"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[24,["userNotesCount"]]],null,{"statements":[[0,"  "],[7,"a",false],[12,"href",""],[12,"title",[29,[[22,"userNotesTitle"]]]],[3,"action",[[23,0,[]],"showUserNotes"]],[8],[0,"\\n"],[4,"if",[[24,["emojiEnabled"]]],null,{"statements":[[0,"      "],[7,"img",true],[11,"src",[22,"emojiUrl"]],[11,"title",[22,"userNotesTitle"]],[10,"alt","pencil"],[10,"class","emoji"],[8],[9],[0,"\\n"]],"parameters":[]},{"statements":[[0,"      "],[1,[28,"d-icon",["sticky-note"],null],false],[0,"\\n"]],"parameters":[]}],[0,"  "],[9],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-user-notes/templates/connectors/after-reviewable-post-user/show-user-notes-on-flags"}}),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/user-profile-controls/show-notes-on-profile"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"li",true],[8],[0,"\\n  "],[1,[28,"show-user-notes",null,[["show","count"],[[28,"action",[[23,0,[]],"showUserNotes"],null],[24,["userNotesCount"]]]]],false],[0,"\\n"],[9],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-user-notes/templates/connectors/user-profile-controls/show-notes-on-profile"}}),Ember.TEMPLATES["javascripts/discourse-user-notes/templates/connectors/admin-user-controls-after/add-user-notes-button"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[28,"show-user-notes",null,[["show","count"],[[28,"action",[[23,0,[]],"showUserNotes"],null],[24,["userNotesCount"]]]]],false],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse-user-notes/templates/connectors/admin-user-controls-after/add-user-notes-button"}}),define("discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes",["exports","discourse/lib/show-modal","discourse/lib/load-script"],function(e,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.showUserNotes=function(e,s,t,o){return o=o||{},(0,r.default)("defer/html-sanitizer-bundle").then(function(){return e.find("user-note",{user_id:s}).then(function(e){e=(0,n.default)("user-notes",{model:e,title:"user_notes.title",addModalBodyView:!0});return e.reset(),e.setProperties({userId:s,callback:t,postId:o.postId}),e})})}});
//# sourceMappingURL=https://sjc6.discourse-cdn.com/nvidia/assets/plugins/discourse-user-notes-e4e94c5f57a12801e1a22a8c0ffbd91b08fecb390770d972d7456a0d72cce31b.js.map